CREATE OR REPLACE VIEW CIRMSCHM.CIRM_ACTOR_VIEW AS
SELECT
a.SR_ACTOR_ID,
a.SR_ACTOR_NAME,
a.SR_ACTOR_LNAME,
a.SR_ACTOR_PHONE_NUMBER,
NVL(SUBSTR(emailIri.IRI, 8),emailIri.IRI) as SR_ACTOR_EMAIL,
a.SR_ACTOR_TYPE,
a.SR_ACTOR_ADDRESS,
addr.FULL_ADDRESS,
addr.STREET_NUMBER,
addr.STREET_NAME,
addr.STREET_NAME_PREFIX,
addr.STREET_NAME_SUFFIX,
addr.UNIT,
addr.CITY,
addr.ZIP,
addr.XCOORDINATE,
addr.YCOORDINATE,
a.SR_ACTOR_WORK_PHONE_NO,
a.SR_ACTOR_CELL_PHONE_NO,
a.SR_ACTOR_FAX_PHONE_NO,
a.SR_ACTOR_OTHER_PHONE_NO,
a.SR_ACTOR_NOTIFICATION_PREF,
a.SR_ACTOR_USERNAME,
a.SR_ACTOR_ORGANIZATION,
a.SR_ACTOR_CHILD_ORG,
a.CREATED_DATE,
a.CREATED_BY,
a.UPDATED_BY,
a.UPDATED_DATE
FROM CIRM_SR_ACTOR a
LEFT JOIN CIRM_IRI emailIri ON a.SR_ACTOR_EMAIL = emailIri.ID
LEFT JOIN CIRM_MDC_ADDRESS addr ON a.SR_ACTOR_ADDRESS = addr.ADDRESS_ID;

CREATE OR REPLACE VIEW CIRMSCHM.CIRM_ACTOR_ASSIGNEE_VIEW AS
SELECT
AV.SR_ACTOR_ID AS ASSIGNEE_ID,
AV.SR_ACTOR_NAME AS ASSIGNEE_NAME,
AV.SR_ACTOR_LNAME AS ASSIGNEE_LNAME,
AV.SR_ACTOR_PHONE_NUMBER AS ASSIGNEE_PHONE_NUMBER,
AV.SR_ACTOR_EMAIL AS ASSIGNEE_EMAIL,
AV.SR_ACTOR_TYPE AS ASSIGNEE_TYPE,
AV.SR_ACTOR_ADDRESS AS ASSIGNEE_ADDRESS,
AV.FULL_ADDRESS AS ASSIGNEE_FULL_ADDRESS,
AV.STREET_NUMBER AS ASSIGNEE_STREET_NUMBER,
AV.STREET_NAME AS ASSIGNEE_STREET_NAME,
AV.STREET_NAME_PREFIX AS ASSIGNEE_STREET_NAME_PREFIX,
AV.STREET_NAME_SUFFIX AS ASSIGNEE_STREET_NAME_SUFFIX,
AV.UNIT AS ASSIGNEE_UNIT,
AV.CITY AS ASSIGNEE_CITY,
AV.ZIP AS ASSIGNEE_ZIP,
AV.XCOORDINATE AS ASSIGNEE_XCOORDINATE,
AV.YCOORDINATE AS ASSIGNEE_YCOORDINATE,
AV.SR_ACTOR_WORK_PHONE_NO AS ASSIGNEE_WORK_PHONE_NO,
AV.SR_ACTOR_CELL_PHONE_NO AS ASSIGNEE_CELL_PHONE_NO,
AV.SR_ACTOR_FAX_PHONE_NO AS ASSIGNEE_FAX_PHONE_NO,
AV.SR_ACTOR_OTHER_PHONE_NO AS ASSIGNEE_OTHER_PHONE_NO,
AV.SR_ACTOR_NOTIFICATION_PREF AS ASSIGNEE_NOTIFICATION_PREF,
AV.SR_ACTOR_USERNAME AS ASSIGNEE_USERNAME,
AV.SR_ACTOR_ORGANIZATION AS ASSIGNEE_ORGANIZATION,
AV.SR_ACTOR_CHILD_ORG AS ASSIGNEE_CHILD_ORG,
AV.CREATED_DATE AS ASSIGNEE_CREATED_DATE,
AV.CREATED_BY AS ASSIGNEE_CREATED_BY,
AV.UPDATED_BY AS ASSIGNEE_UPDATED_BY,
AV.UPDATED_DATE AS ASSIGNEE_UPDATED_DATE
FROM CIRM_ACTOR_VIEW AV
WHERE AV.SR_ACTOR_TYPE = 'ASSIGNEE';

CREATE OR REPLACE VIEW CIRMSCHM.CIRM_ACTOR_CITIZEN_VIEW AS
SELECT
AV.SR_ACTOR_ID AS CITIZEN_ID,
AV.SR_ACTOR_NAME AS CITIZEN_NAME,
AV.SR_ACTOR_LNAME AS CITIZEN_LNAME,
AV.SR_ACTOR_PHONE_NUMBER AS CITIZEN_PHONE_NUMBER,
AV.SR_ACTOR_EMAIL AS CITIZEN_EMAIL,
AV.SR_ACTOR_TYPE AS CITIZEN_TYPE,
AV.SR_ACTOR_ADDRESS AS CITIZEN_ADDRESS,
AV.FULL_ADDRESS AS CITIZEN_FULL_ADDRESS,
AV.STREET_NUMBER AS CITIZEN_STREET_NUMBER,
AV.STREET_NAME AS CITIZEN_STREET_NAME,
AV.STREET_NAME_PREFIX AS CITIZEN_STREET_NAME_PREFIX,
AV.STREET_NAME_SUFFIX AS CITIZEN_STREET_NAME_SUFFIX,
AV.UNIT AS CITIZEN_UNIT,
AV.CITY AS CITIZEN_CITY,
AV.ZIP AS CITIZEN_ZIP,
AV.XCOORDINATE AS CITIZEN_XCOORDINATE,
AV.YCOORDINATE AS CITIZEN_YCOORDINATE,
AV.SR_ACTOR_WORK_PHONE_NO AS CITIZEN_WORK_PHONE_NO,
AV.SR_ACTOR_CELL_PHONE_NO AS CITIZEN_CELL_PHONE_NO,
AV.SR_ACTOR_FAX_PHONE_NO AS CITIZEN_FAX_PHONE_NO,
AV.SR_ACTOR_OTHER_PHONE_NO AS CITIZEN_OTHER_PHONE_NO,
AV.SR_ACTOR_NOTIFICATION_PREF AS CITIZEN_NOTIFICATION_PREF,
AV.SR_ACTOR_USERNAME AS CITIZEN_USERNAME,
AV.SR_ACTOR_ORGANIZATION AS CITIZEN_ORGANIZATION,
AV.SR_ACTOR_CHILD_ORG AS CITIZEN_CHILD_ORG,
AV.CREATED_DATE AS CITIZEN_CREATED_DATE,
AV.CREATED_BY AS CITIZEN_CREATED_BY,
AV.UPDATED_BY AS CITIZEN_UPDATED_BY,
AV.UPDATED_DATE AS CITIZEN_UPDATED_DATE
FROM CIRM_ACTOR_VIEW AV
WHERE AV.SR_ACTOR_TYPE = 'CITIZEN';

CREATE OR REPLACE VIEW CIRMSCHM.CIRM_ACTOR_EXTAGENCYM_VIEW AS
SELECT
AV.SR_ACTOR_ID AS EXTAGENCYM_ID,
AV.SR_ACTOR_NAME AS EXTAGENCYM_NAME,
AV.SR_ACTOR_LNAME AS EXTAGENCYM_LNAME,
AV.SR_ACTOR_PHONE_NUMBER AS EXTAGENCYM_PHONE_NUMBER,
AV.SR_ACTOR_EMAIL AS EXTAGENCYM_EMAIL,
AV.SR_ACTOR_TYPE AS EXTAGENCYM_TYPE,
AV.SR_ACTOR_ADDRESS AS EXTAGENCYM_ADDRESS,
AV.FULL_ADDRESS AS EXTAGENCYM_FULL_ADDRESS,
AV.STREET_NUMBER AS EXTAGENCYM_STREET_NUMBER,
AV.STREET_NAME AS EXTAGENCYM_STREET_NAME,
AV.STREET_NAME_PREFIX AS EXTAGENCYM_STREET_NAME_PREFIX,
AV.STREET_NAME_SUFFIX AS EXTAGENCYM_STREET_NAME_SUFFIX,
AV.UNIT AS EXTAGENCYM_UNIT,
AV.CITY AS EXTAGENCYM_CITY,
AV.ZIP AS EXTAGENCYM_ZIP,
AV.XCOORDINATE AS EXTAGENCYM_XCOORDINATE,
AV.YCOORDINATE AS EXTAGENCYM_YCOORDINATE,
AV.SR_ACTOR_WORK_PHONE_NO AS EXTAGENCYM_WORK_PHONE_NO,
AV.SR_ACTOR_CELL_PHONE_NO AS EXTAGENCYM_CELL_PHONE_NO,
AV.SR_ACTOR_FAX_PHONE_NO AS EXTAGENCYM_FAX_PHONE_NO,
AV.SR_ACTOR_OTHER_PHONE_NO AS EXTAGENCYM_OTHER_PHONE_NO,
AV.SR_ACTOR_NOTIFICATION_PREF AS EXTAGENCYM_NOTIFICATION_PREF,
AV.SR_ACTOR_USERNAME AS EXTAGENCYM_USERNAME,
AV.SR_ACTOR_ORGANIZATION AS EXTAGENCYM_ORGANIZATION,
AV.SR_ACTOR_CHILD_ORG AS EXTAGENCYM_CHILD_ORG,
AV.CREATED_DATE AS EXTAGENCYM_CREATED_DATE,
AV.CREATED_BY AS EXTAGENCYM_CREATED_BY,
AV.UPDATED_BY AS EXTAGENCYM_UPDATED_BY,
AV.UPDATED_DATE AS EXTAGENCYM_UPDATED_DATE
FROM CIRM_ACTOR_VIEW AV
WHERE AV.SR_ACTOR_TYPE = 'EXTAGENCYM';

CREATE OR REPLACE VIEW CIRMSCHM.CIRM_ACTOR_MDCDEPTM_VIEW AS
SELECT
AV.SR_ACTOR_ID AS MDCDEPTM_ID,
AV.SR_ACTOR_NAME AS MDCDEPTM_NAME,
AV.SR_ACTOR_LNAME AS MDCDEPTM_LNAME,
AV.SR_ACTOR_PHONE_NUMBER AS MDCDEPTM_PHONE_NUMBER,
AV.SR_ACTOR_EMAIL AS MDCDEPTM_EMAIL,
AV.SR_ACTOR_TYPE AS MDCDEPTM_TYPE,
AV.SR_ACTOR_ADDRESS AS MDCDEPTM_ADDRESS,
AV.FULL_ADDRESS AS MDCDEPTM_FULL_ADDRESS,
AV.STREET_NUMBER AS MDCDEPTM_STREET_NUMBER,
AV.STREET_NAME AS MDCDEPTM_STREET_NAME,
AV.STREET_NAME_PREFIX AS MDCDEPTM_STREET_NAME_PREFIX,
AV.STREET_NAME_SUFFIX AS MDCDEPTM_STREET_NAME_SUFFIX,
AV.UNIT AS MDCDEPTM_UNIT,
AV.CITY AS MDCDEPTM_CITY,
AV.ZIP AS MDCDEPTM_ZIP,
AV.XCOORDINATE AS MDCDEPTM_XCOORDINATE,
AV.YCOORDINATE AS MDCDEPTM_YCOORDINATE,
AV.SR_ACTOR_WORK_PHONE_NO AS MDCDEPTM_WORK_PHONE_NO,
AV.SR_ACTOR_CELL_PHONE_NO AS MDCDEPTM_CELL_PHONE_NO,
AV.SR_ACTOR_FAX_PHONE_NO AS MDCDEPTM_FAX_PHONE_NO,
AV.SR_ACTOR_OTHER_PHONE_NO AS MDCDEPTM_OTHER_PHONE_NO,
AV.SR_ACTOR_NOTIFICATION_PREF AS MDCDEPTM_NOTIFICATION_PREF,
AV.SR_ACTOR_USERNAME AS MDCDEPTM_USERNAME,
AV.SR_ACTOR_ORGANIZATION AS MDCDEPTM_ORGANIZATION,
AV.SR_ACTOR_CHILD_ORG AS MDCDEPTM_CHILD_ORG,
AV.CREATED_DATE AS MDCDEPTM_CREATED_DATE,
AV.CREATED_BY AS MDCDEPTM_CREATED_BY,
AV.UPDATED_BY AS MDCDEPTM_UPDATED_BY,
AV.UPDATED_DATE AS MDCDEPTM_UPDATED_DATE
FROM CIRM_ACTOR_VIEW AV
WHERE AV.SR_ACTOR_TYPE = 'MDCDEPTM';

CREATE OR REPLACE VIEW CIRMSCHM.CIRM_SCA_CLOSE_VIEW AS
SELECT
SR_REQUEST_ID, COMPLETE_DATE AS CLOSE_DATE
FROM CIRM_SR_ACTIVITY
where ACTIVITY_CODE = 'StatusChangeActivity'
and OUTCOME_CODE in ('C-CLOSED', 'C-VOID', 'C-LIEN', 'C-DUP', 'C-CANCEL')

CREATE OR REPLACE VIEW CIRMSCHM.CIRM_REMINDER_ACTIVE_VIEW AS
select
"ACTIVITY_ID",
"SR_REQUEST_ID",
"STAFF_ASSIGNED",
"ACTIVITY_CODE",
"OUTCOME_CODE",
"DETAILS",
"DUE_DATE",
"COMPLETE_DATE",
"CREATED_BY",
"CREATED_DATE",
"UPDATED_BY",
"UPDATED_DATE",
"SYS_CREATED_DATE"
FROM CIRM_SR_ACTIVITY
WHERE CIRM_SR_ACTIVITY.ACTIVITY_CODE = 'MDSHARED_REMINDER'
AND ( OUTCOME_CODE <> 'OUTCOME_COMPLETE' OR OUTCOME_CODE IS NULL )

CREATE OR REPLACE VIEW CIRMSCHM.CIRM_CCRM_FULL_VIEW AS
select
"SR_REQUEST_ID",
"SR_TYPE",
"SR_TYPE_IRI",
"SR_STATUS",
"CASE_NUMBER",
"SR_INTAKE_METHOD",
"SR_PRIORITY",
"SR_REQUEST_ADDRESS",
"GIS_INFO_ID",
"SR_XCOORDINATE",
"SR_YCOORDINATE",
"SR_DESCRIPTION",
"DUE_DATE",
"REMINDER_NEXT_DUE_DATE",
LEAST(NVL("DUE_DATE", "REMINDER_NEXT_DUE_DATE"), NVL("REMINDER_NEXT_DUE_DATE", "DUE_DATE")) AS NEXT_DUE_DATE,
"CREATED_BY",
"CREATED_DATE",
"UPDATED_BY",
"UPDATED_DATE",
"SR_CLOSED_DATE",
"SR_FOLIO",
"SR_FULL_ADDRESS",
"SR_STREET_NUMBER",
"SR_STREET_NAME",
"SR_STREET_NAME_PREFIX",
"SR_STREET_NAME_SUFFIX",
"SR_UNIT",
"SR_CITY",
"SR_STATE",
"SR_ZIP",
"LOCATION_NAME",
"CITIZEN_ID",
"CITIZEN_NAME",
"CITIZEN_LNAME",
"CITIZEN_PHONE_NUMBER",
"CITIZEN_EMAIL",
"CITIZEN_TYPE",
"CITIZEN_ADDRESS",
"CITIZEN_FULL_ADDRESS",
"CITIZEN_STREET_NUMBER",
"CITIZEN_STREET_NAME",
"CITIZEN_STREET_NAME_PREFIX",
"CITIZEN_STREET_NAME_SUFFIX",
"CITIZEN_UNIT",
"CITIZEN_CITY",
"CITIZEN_ZIP",
"CITIZEN_XCOORDINATE",
"CITIZEN_YCOORDINATE",
"CITIZEN_WORK_PHONE_NO",
"CITIZEN_CELL_PHONE_NO",
"CITIZEN_FAX_PHONE_NO",
"CITIZEN_OTHER_PHONE_NO",
"CITIZEN_NOTIFICATION_PREF",
"CITIZEN_USERNAME",
"CITIZEN_ORGANIZATION",
"CITIZEN_CHILD_ORG",
"CITIZEN_CREATED_DATE",
"CITIZEN_CREATED_BY",
"CITIZEN_UPDATED_BY",
"CITIZEN_UPDATED_DATE",
"XA_SR_REQUEST_ID",
"ASSIGNEE_ID",
"ASSIGNEE_NAME",
"ASSIGNEE_LNAME",
"ASSIGNEE_PHONE_NUMBER",
"ASSIGNEE_EMAIL",
"ASSIGNEE_TYPE",
"ASSIGNEE_ADDRESS",
"ASSIGNEE_FULL_ADDRESS",
"ASSIGNEE_STREET_NUMBER",
"ASSIGNEE_STREET_NAME",
"ASSIGNEE_STREET_NAME_PREFIX",
"ASSIGNEE_STREET_NAME_SUFFIX",
"ASSIGNEE_UNIT",
"ASSIGNEE_CITY",
"ASSIGNEE_ZIP",
"ASSIGNEE_XCOORDINATE",
"ASSIGNEE_YCOORDINATE",
"ASSIGNEE_WORK_PHONE_NO",
"ASSIGNEE_CELL_PHONE_NO",
"ASSIGNEE_FAX_PHONE_NO",
"ASSIGNEE_OTHER_PHONE_NO",
"ASSIGNEE_NOTIFICATION_PREF",
"ASSIGNEE_USERNAME",
"ASSIGNEE_ORGANIZATION",
"ASSIGNEE_CHILD_ORG",
"ASSIGNEE_CREATED_DATE",
"ASSIGNEE_CREATED_BY",
"ASSIGNEE_UPDATED_BY",
"ASSIGNEE_UPDATED_DATE",
"XM_SR_REQUEST_ID",
"MDCDEPTM_ID",
"MDCDEPTM_NAME",
"MDCDEPTM_LNAME",
"MDCDEPTM_PHONE_NUMBER",
"MDCDEPTM_EMAIL",
"MDCDEPTM_TYPE",
"MDCDEPTM_ADDRESS",
"MDCDEPTM_FULL_ADDRESS",
"MDCDEPTM_STREET_NUMBER",
"MDCDEPTM_STREET_NAME",
"MDCDEPTM_STREET_NAME_PREFIX",
"MDCDEPTM_STREET_NAME_SUFFIX",
"MDCDEPTM_UNIT",
"MDCDEPTM_CITY",
"MDCDEPTM_ZIP",
"MDCDEPTM_XCOORDINATE",
"MDCDEPTM_YCOORDINATE",
"MDCDEPTM_WORK_PHONE_NO",
"MDCDEPTM_CELL_PHONE_NO",
"MDCDEPTM_FAX_PHONE_NO",
"MDCDEPTM_OTHER_PHONE_NO",
"MDCDEPTM_NOTIFICATION_PREF",
"MDCDEPTM_USERNAME",
"MDCDEPTM_ORGANIZATION",
"MDCDEPTM_CHILD_ORG",
"MDCDEPTM_CREATED_DATE",
"MDCDEPTM_CREATED_BY",
"MDCDEPTM_UPDATED_BY",
"MDCDEPTM_UPDATED_DATE",
"XE_SR_REQUEST_ID",
"EXTAGENCYM_ID",
"EXTAGENCYM_NAME",
"EXTAGENCYM_LNAME",
"EXTAGENCYM_PHONE_NUMBER",
"EXTAGENCYM_EMAIL",
"EXTAGENCYM_TYPE",
"EXTAGENCYM_ADDRESS",
"EXTAGENCYM_FULL_ADDRESS",
"EXTAGENCYM_STREET_NUMBER",
"EXTAGENCYM_STREET_NAME",
"EXTAGENCYM_STREET_NAME_PREFIX",
"EXTAGENCYM_STREET_NAME_SUFFIX",
"EXTAGENCYM_UNIT",
"EXTAGENCYM_CITY",
"EXTAGENCYM_ZIP",
"EXTAGENCYM_XCOORDINATE",
"EXTAGENCYM_YCOORDINATE",
"EXTAGENCYM_WORK_PHONE_NO",
"EXTAGENCYM_CELL_PHONE_NO",
"EXTAGENCYM_FAX_PHONE_NO",
"EXTAGENCYM_OTHER_PHONE_NO",
"EXTAGENCYM_NOTIFICATION_PREF",
"EXTAGENCYM_USERNAME",
"EXTAGENCYM_ORGANIZATION",
"EXTAGENCYM_CHILD_ORG",
"EXTAGENCYM_CREATED_DATE",
"EXTAGENCYM_CREATED_BY",
"EXTAGENCYM_UPDATED_BY",
"EXTAGENCYM_UPDATED_DATE"
from
(
   SELECT
   SR.SR_REQUEST_ID,
   SR.SR_TYPE,
   SR.SR_TYPE_IRI,
   SR.SR_STATUS,
   SR.CASE_NUMBER,
   SR.SR_INTAKE_METHOD,
   SR.SR_PRIORITY,
   SR.SR_REQUEST_ADDRESS,
   SR.GIS_INFO_ID,
   SR.SR_XCOORDINATE,
   SR.SR_YCOORDINATE,
   SR.SR_DESCRIPTION,
   SR.DUE_DATE,
   SR.CREATED_BY,
   SR.CREATED_DATE,
   (SELECT MIN(REMINDER_ACTIVE.DUE_DATE) FROM CIRM_REMINDER_ACTIVE_VIEW REMINDER_ACTIVE where REMINDER_ACTIVE.SR_REQUEST_ID = SR.SR_REQUEST_ID and REMINDER_ACTIVE.DUE_DATE >= CREATED_DATE) AS REMINDER_NEXT_DUE_DATE,
   SR.UPDATED_BY,
   SR.UPDATED_DATE,
   (SELECT MIN(CIRM_SR_ACTIVITY.COMPLETE_DATE) FROM CIRM_SR_ACTIVITY where CIRM_SR_ACTIVITY.SR_REQUEST_ID = SR.SR_REQUEST_ID AND CIRM_SR_ACTIVITY.ACTIVITY_CODE = 'StatusChangeActivity' AND CIRM_SR_ACTIVITY.OUTCOME_CODE in ('C-CLOSED', 'C-VOID', 'C-LIEN', 'C-DUP', 'C-CANCEL') AND CIRM_SR_ACTIVITY.COMPLETE_DATE >= SR.CREATED_DATE) AS SR_CLOSED_DATE,
   SR.SR_FOLIO,
   SR.FULL_ADDRESS AS SR_FULL_ADDRESS,
   SR.STREET_NUMBER AS SR_STREET_NUMBER,
   SR.STREET_NAME AS SR_STREET_NAME,
   SR.STREET_NAME_PREFIX AS SR_STREET_NAME_PREFIX,
   SR.STREET_NAME_SUFFIX AS SR_STREET_NAME_SUFFIX,
   SR.UNIT AS SR_UNIT,
   SR.CITY AS SR_CITY,
   SR.STATE AS SR_STATE,
   SR.ZIP AS SR_ZIP,
   SR.LOCATION_NAME,
   A.*
   FROM CIRM_SR_REQUESTS_VIEW SR left outer
   join CIRM_SRREQ_SRACTOR XASR ON(SR.SR_REQUEST_ID = XASR.SR_REQUEST_ID)
   inner join CIRM_ACTOR_CITIZEN_VIEW A ON (A.CITIZEN_ID = XASR.SR_ACTOR_ID)
)
CITIZEN left outer
join
(
   SELECT
   XASR.SR_REQUEST_ID AS XA_SR_REQUEST_ID, A.*
   FROM CIRM_SRREQ_SRACTOR XASR
   inner join CIRM_ACTOR_ASSIGNEE_VIEW A ON (A.ASSIGNEE_ID = XASR.SR_ACTOR_ID)
)
ASSIGNEE ON(CITIZEN.SR_REQUEST_ID = ASSIGNEE.XA_SR_REQUEST_ID) left outer
join
(
   SELECT
   XASR.SR_REQUEST_ID AS XM_SR_REQUEST_ID, A.*
   FROM CIRM_SRREQ_SRACTOR XASR
   inner join CIRM_ACTOR_MDCDEPTM_VIEW A ON (A.MDCDEPTM_ID = XASR.SR_ACTOR_ID)
)
MDCDEPTM ON(CITIZEN.SR_REQUEST_ID = MDCDEPTM.XM_SR_REQUEST_ID) left outer
join
(
   SELECT
   XASR.SR_REQUEST_ID AS XE_SR_REQUEST_ID, A.*
   FROM CIRM_SRREQ_SRACTOR XASR
   inner join CIRM_ACTOR_EXTAGENCYM_VIEW A ON (A.EXTAGENCYM_ID = XASR.SR_ACTOR_ID)
)
EXTAGENCYM ON(CITIZEN.SR_REQUEST_ID = EXTAGENCYM.XE_SR_REQUEST_ID);


CREATE OR REPLACE VIEW CIRMSCHM.CIRM_CCRM_VIEW AS
SELECT
"SR_REQUEST_ID",
"SR_TYPE_IRI",
"SR_STATUS",
"CASE_NUMBER",
"SR_INTAKE_METHOD",
"SR_PRIORITY",
"SR_REQUEST_ADDRESS",
"SR_XCOORDINATE",
"SR_YCOORDINATE",
"SR_DESCRIPTION",
"DUE_DATE",
"REMINDER_NEXT_DUE_DATE",
"NEXT_DUE_DATE",
"SR_CLOSED_DATE",
"CREATED_BY",
"CREATED_DATE",
"UPDATED_BY",
"UPDATED_DATE",
"SR_FOLIO",
"SR_FULL_ADDRESS",
"SR_UNIT",
"SR_ZIP",
"CITIZEN_NAME",
"CITIZEN_LNAME",
"CITIZEN_PHONE_NUMBER",
"CITIZEN_EMAIL",
"CITIZEN_TYPE",
"CITIZEN_FULL_ADDRESS",
"CITIZEN_UNIT",
"CITIZEN_ZIP",
"CITIZEN_WORK_PHONE_NO",
"CITIZEN_CELL_PHONE_NO",
"CITIZEN_FAX_PHONE_NO",
"CITIZEN_OTHER_PHONE_NO",
"ASSIGNEE_NAME",
"ASSIGNEE_LNAME",
"ASSIGNEE_USERNAME",
"MDCDEPTM_NAME",
"MDCDEPTM_LNAME",
"MDCDEPTM_USERNAME",
"MDCDEPTM_ORGANIZATION",
"MDCDEPTM_CHILD_ORG",
"EXTAGENCYM_NAME",
"EXTAGENCYM_LNAME",
"EXTAGENCYM_ORGANIZATION",
"EXTAGENCYM_CHILD_ORG"
FROM CIRM_CCRM_FULL_VIEW;
